FROM scratch

ARG ODH_RHEL8_OPERATOR_GIT_URL=
ARG ODH_RHEL8_OPERATOR_GIT_COMMIT=
ARG ODH_KF_NOTEBOOK_CONTROLLER_GIT_URL=
ARG ODH_KF_NOTEBOOK_CONTROLLER_GIT_COMMIT=
ARG ODH_NOTEBOOK_CONTROLLER_GIT_URL=
ARG ODH_NOTEBOOK_CONTROLLER_GIT_COMMIT=
ARG ODH_DATA_SCIENCE_PIPELINES_OPERATOR_CONTROLLER_GIT_URL=
ARG ODH_DATA_SCIENCE_PIPELINES_OPERATOR_CONTROLLER_GIT_COMMIT=
ARG ODH_CODEFLARE_OPERATOR_GIT_URL=
ARG ODH_CODEFLARE_OPERATOR_GIT_COMMIT=
ARG ODH_KUBERAY_OPERATOR_CONTROLLER_GIT_URL=
ARG ODH_KUBERAY_OPERATOR_CONTROLLER_GIT_COMMIT=
ARG ODH_KUEUE_CONTROLLER_GIT_URL=
ARG ODH_KUEUE_CONTROLLER_GIT_COMMIT=
ARG ODH_TRUSTYAI_SERVICE_OPERATOR_GIT_URL=
ARG ODH_TRUSTYAI_SERVICE_OPERATOR_GIT_COMMIT=
ARG ODH_MODEL_CONTROLLER_GIT_URL=
ARG ODH_MODEL_CONTROLLER_GIT_COMMIT=
ARG ODH_MODELMESH_GIT_URL=
ARG ODH_MODELMESH_GIT_COMMIT=
ARG ODH_DASHBOARD_GIT_URL=
ARG ODH_DASHBOARD_GIT_COMMIT=
ARG ODH_TRAINING_OPERATOR_GIT_URL=
ARG ODH_TRAINING_OPERATOR_GIT_COMMIT=
ARG ODH_ML_PIPELINES_PERSISTENCEAGENT_GIT_URL=
ARG ODH_ML_PIPELINES_PERSISTENCEAGENT_GIT_COMMIT=
ARG ODH_ML_PIPELINES_SCHEDULEDWORKFLOW_GIT_URL=
ARG ODH_ML_PIPELINES_SCHEDULEDWORKFLOW_GIT_COMMIT=
ARG ODH_ML_PIPELINES_ARTIFACT_MANAGER_GIT_URL=
ARG ODH_ML_PIPELINES_ARTIFACT_MANAGER_GIT_COMMIT=
ARG ODH_MODELMESH_SERVING_CONTROLLER_GIT_URL=
ARG ODH_MODELMESH_SERVING_CONTROLLER_GIT_COMMIT=
ARG ODH_MM_REST_PROXY_GIT_URL=
ARG ODH_MM_REST_PROXY_GIT_COMMIT=
ARG ODH_MODELMESH_RUNTIME_ADAPTER_GIT_URL=
ARG ODH_MODELMESH_RUNTIME_ADAPTER_GIT_COMMIT=
ARG ODH_TRUSTYAI_SERVICE_GIT_URL=
ARG ODH_TRUSTYAI_SERVICE_GIT_COMMIT=
ARG ODH_MLMD_GRPC_SERVER_GIT_URL=
ARG ODH_MLMD_GRPC_SERVER_GIT_COMMIT=
ARG ODH_ML_PIPELINES_API_SERVER_V2_GIT_URL=
ARG ODH_ML_PIPELINES_API_SERVER_V2_GIT_COMMIT=
ARG ODH_ML_PIPELINES_PERSISTENCEAGENT_V2_GIT_URL=
ARG ODH_ML_PIPELINES_PERSISTENCEAGENT_V2_GIT_COMMIT=
ARG ODH_ML_PIPELINES_SCHEDULEDWORKFLOW_V2_GIT_URL=
ARG ODH_ML_PIPELINES_SCHEDULEDWORKFLOW_V2_GIT_COMMIT=
ARG ODH_ML_PIPELINES_DRIVER_GIT_URL=
ARG ODH_ML_PIPELINES_DRIVER_GIT_COMMIT=
ARG ODH_ML_PIPELINES_LAUNCHER_GIT_URL=
ARG ODH_ML_PIPELINES_LAUNCHER_GIT_COMMIT=
ARG ODH_DATA_SCIENCE_PIPELINES_ARGO_ARGOEXEC_GIT_URL=
ARG ODH_DATA_SCIENCE_PIPELINES_ARGO_ARGOEXEC_GIT_COMMIT=
ARG ODH_DATA_SCIENCE_PIPELINES_ARGO_WORKFLOWCONTROLLER_GIT_URL=
ARG ODH_DATA_SCIENCE_PIPELINES_ARGO_WORKFLOWCONTROLLER_GIT_COMMIT=
ARG ODH_MODEL_REGISTRY_GIT_URL=
ARG ODH_MODEL_REGISTRY_GIT_COMMIT=
ARG ODH_MODEL_REGISTRY_OPERATOR_GIT_URL=
ARG ODH_MODEL_REGISTRY_OPERATOR_GIT_COMMIT=

# Core bundle labels.
LABEL operators.operatorframework.io.bundle.mediatype.v1=registry+v1
LABEL operators.operatorframework.io.bundle.manifests.v1=manifests/
LABEL operators.operatorframework.io.bundle.metadata.v1=metadata/
LABEL operators.operatorframework.io.bundle.package.v1=rhods-operator
LABEL operators.operatorframework.io.metrics.builder=operator-sdk-v1.31.0
LABEL operators.operatorframework.io.metrics.mediatype.v1=metrics+v1
LABEL operators.operatorframework.io.metrics.project_layout=go.kubebuilder.io/v3

# Labels for testing.
LABEL operators.operatorframework.io.test.mediatype.v1=scorecard+v1
LABEL operators.operatorframework.io.test.config.v1=tests/scorecard/

LABEL \
      odh-rhel8-operator.git.url="${ODH_RHEL8_OPERATOR_GIT_URL}" \
      odh-rhel8-operator.git.commit="${ODH_RHEL8_OPERATOR_GIT_COMMIT}" \
      odh-kf-notebook-controller.git.url="${ODH_KF_NOTEBOOK_CONTROLLER_GIT_URL}" \
      odh-kf-notebook-controller.git.commit="${ODH_KF_NOTEBOOK_CONTROLLER_GIT_COMMIT}" \
      odh-notebook-controller.git.url="${ODH_NOTEBOOK_CONTROLLER_GIT_URL}" \
      odh-notebook-controller.git.commit="${ODH_NOTEBOOK_CONTROLLER_GIT_COMMIT}" \
      odh-data-science-pipelines-operator-controller.git.url="${ODH_DATA_SCIENCE_PIPELINES_OPERATOR_CONTROLLER_GIT_URL}" \
      odh-data-science-pipelines-operator-controller.git.commit="${ODH_DATA_SCIENCE_PIPELINES_OPERATOR_CONTROLLER_GIT_COMMIT}" \
      odh-codeflare-operator.git.url="${ODH_CODEFLARE_OPERATOR_GIT_URL}" \
      odh-codeflare-operator.git.commit="${ODH_CODEFLARE_OPERATOR_GIT_COMMIT}" \
      odh-kuberay-operator-controller.git.url="${ODH_KUBERAY_OPERATOR_CONTROLLER_GIT_URL}" \
      odh-kuberay-operator-controller.git.commit="${ODH_KUBERAY_OPERATOR_CONTROLLER_GIT_COMMIT}" \
      odh-kueue-controller.git.url="${ODH_KUEUE_CONTROLLER_GIT_URL}" \
      odh-kueue-controller.git.commit="${ODH_KUEUE_CONTROLLER_GIT_COMMIT}" \
      odh-trustyai-service-operator.git.url="${ODH_TRUSTYAI_SERVICE_OPERATOR_GIT_URL}" \
      odh-trustyai-service-operator.git.commit="${ODH_TRUSTYAI_SERVICE_OPERATOR_GIT_COMMIT}" \
      odh-model-controller.git.url="${ODH_MODEL_CONTROLLER_GIT_URL}" \
      odh-model-controller.git.commit="${ODH_MODEL_CONTROLLER_GIT_COMMIT}" \
      odh-modelmesh.git.url="${ODH_MODELMESH_GIT_URL}" \
      odh-modelmesh.git.commit="${ODH_MODELMESH_GIT_COMMIT}" \
      odh-dashboard.git.url="${ODH_DASHBOARD_GIT_URL}" \
      odh-dashboard.git.commit="${ODH_DASHBOARD_GIT_COMMIT}" \
      odh-training-operator.git.url="${ODH_TRAINING_OPERATOR_GIT_URL}" \
      odh-training-operator.git.commit="${ODH_TRAINING_OPERATOR_GIT_COMMIT}" \
      odh-ml-pipelines-persistenceagent.git.url="${ODH_ML_PIPELINES_PERSISTENCEAGENT_GIT_URL}" \
      odh-ml-pipelines-persistenceagent.git.commit="${ODH_ML_PIPELINES_PERSISTENCEAGENT_GIT_COMMIT}" \
      odh-ml-pipelines-scheduledworkflow.git.url="${ODH_ML_PIPELINES_SCHEDULEDWORKFLOW_GIT_URL}" \
      odh-ml-pipelines-scheduledworkflow.git.commit="${ODH_ML_PIPELINES_SCHEDULEDWORKFLOW_GIT_COMMIT}" \
      odh-ml-pipelines-artifact-manager.git.url="${ODH_ML_PIPELINES_ARTIFACT_MANAGER_GIT_URL}" \
      odh-ml-pipelines-artifact-manager.git.commit="${ODH_ML_PIPELINES_ARTIFACT_MANAGER_GIT_COMMIT}" \
      odh-modelmesh-serving-controller.git.url="${ODH_MODELMESH_SERVING_CONTROLLER_GIT_URL}" \
      odh-modelmesh-serving-controller.git.commit="${ODH_MODELMESH_SERVING_CONTROLLER_GIT_COMMIT}" \
      odh-mm-rest-proxy.git.url="${ODH_MM_REST_PROXY_GIT_URL}" \
      odh-mm-rest-proxy.git.commit="${ODH_MM_REST_PROXY_GIT_COMMIT}" \
      odh-modelmesh-runtime-adapter.git.url="${ODH_MODELMESH_RUNTIME_ADAPTER_GIT_URL}" \
      odh-modelmesh-runtime-adapter.git.commit="${ODH_MODELMESH_RUNTIME_ADAPTER_GIT_COMMIT}" \
      odh-trustyai-service.git.url="${ODH_TRUSTYAI_SERVICE_GIT_URL}" \
      odh-trustyai-service.git.commit="${ODH_TRUSTYAI_SERVICE_GIT_COMMIT}" \
      odh-mlmd-grpc-server.git.url="${ODH_MLMD_GRPC_SERVER_GIT_URL}" \
      odh-mlmd-grpc-server.git.commit="${ODH_MLMD_GRPC_SERVER_GIT_COMMIT}" \
      odh-ml-pipelines-api-server-v2.git.url="${ODH_ML_PIPELINES_API_SERVER_V2_GIT_URL}" \
      odh-ml-pipelines-api-server-v2.git.commit="${ODH_ML_PIPELINES_API_SERVER_V2_GIT_COMMIT}" \
      odh-ml-pipelines-persistenceagent-v2.git.url="${ODH_ML_PIPELINES_PERSISTENCEAGENT_V2_GIT_URL}" \
      odh-ml-pipelines-persistenceagent-v2.git.commit="${ODH_ML_PIPELINES_PERSISTENCEAGENT_V2_GIT_COMMIT}" \
      odh-ml-pipelines-scheduledworkflow-v2.git.url="${ODH_ML_PIPELINES_SCHEDULEDWORKFLOW_V2_GIT_URL}" \
      odh-ml-pipelines-scheduledworkflow-v2.git.commit="${ODH_ML_PIPELINES_SCHEDULEDWORKFLOW_V2_GIT_COMMIT}" \
      odh-ml-pipelines-driver.git.url="${ODH_ML_PIPELINES_DRIVER_GIT_URL}" \
      odh-ml-pipelines-driver.git.commit="${ODH_ML_PIPELINES_DRIVER_GIT_COMMIT}" \
      odh-ml-pipelines-launcher.git.url="${ODH_ML_PIPELINES_LAUNCHER_GIT_URL}" \
      odh-ml-pipelines-launcher.git.commit="${ODH_ML_PIPELINES_LAUNCHER_GIT_COMMIT}" \
      odh-data-science-pipelines-argo-argoexec.git.url="${ODH_DATA_SCIENCE_PIPELINES_ARGO_ARGOEXEC_GIT_URL}" \
      odh-data-science-pipelines-argo-argoexec.git.commit="${ODH_DATA_SCIENCE_PIPELINES_ARGO_ARGOEXEC_GIT_COMMIT}" \
      odh-data-science-pipelines-argo-workflowcontroller.git.url="${ODH_DATA_SCIENCE_PIPELINES_ARGO_WORKFLOWCONTROLLER_GIT_URL}" \
      odh-data-science-pipelines-argo-workflowcontroller.git.commit="${ODH_DATA_SCIENCE_PIPELINES_ARGO_WORKFLOWCONTROLLER_GIT_COMMIT}" \
      odh-model-registry.git.url="${ODH_MODEL_REGISTRY_GIT_URL}" \
      odh-model-registry.git.commit="${ODH_MODEL_REGISTRY_GIT_COMMIT}" \
      odh-model-registry-operator.git.url="${ODH_MODEL_REGISTRY_OPERATOR_GIT_URL}" \
      odh-model-registry-operator.git.commit="${ODH_MODEL_REGISTRY_OPERATOR_GIT_COMMIT}"
# Copy files to locations specified by labels.

LABEL com.redhat.component="odh-operator-bundle" \
      description="odh-operator-bundle" \
      distribution-scope="public" \
      name="managed-open-data-hub/odh-operator-bundle" \
      vendor="Red Hat, Inc." \
      summary="odh-operator-bundle" \
      maintainer="['managed-open-data-hub@redhat.com']" \
      io.k8s.display-name="odh-operator-bundle" \
      io.k8s.description="odh-operator-bundle" \
      com.redhat.delivery.operator.bundle="true" \
      com.redhat.license_terms="https://www.redhat.com/licenses/Red_Hat_Standard_EULA_20191108.pdf"

COPY bundle/manifests /manifests/
COPY bundle/metadata /metadata/
COPY bundle/tests/scorecard /tests/scorecard/